---
layout: post
title: Веб-акселерация в Django
image: /assets/images/covers/varnish.jpg
tags:
  - varnish
  - highload
---

Основным способом увеличить производительность веб-приложения является кеширование. В Django кешировать приходиться почти все:

- пользовательские аккаунты; 
- шаблоны и их части (можно использовать например [django-phased](https://github.com/codysoyland/django-phased)); 
- запросы к БД; 
- ответы от view;
- и т.д.  

Идеальный случай это не ходить на бекенд вообще. Такое реально на большинстве страниц новостных сайтов. 
Иногда необходимо авторизовать пользователя, дать ему возможность подписаться, оставить комментарий и т.п. А остальное по 
сути является статикой, которую можно сгенерировать заранее и инвалидировать по мере необходимости. Рассмотрим способы, 
которые позволят нам не обращаться к бекенду. 

### Первый вариант: для «самостоятельных»

По запросы пользователей можно генерировать html файлы на каждую страница и отдавать их c помощью nginx, как и положено поступать со статикой. 

Количество таких файлов будет зависеть от параметров страницы, например языка, авторизованности пользователя и прочих 
параметров, которые вам необходимо учитывать. Эти параметры также будут необходимо определять с помощью nginx. 
Таким образом мы получаем сквозное кеширование (надо только инвалидацию продумать, например можно просто удалять файлы) 
и много дополнительных подводных камней, которые со временем могут быть решены.
 
Можно воспользоваться кешированием с помощью средств nginx, однако в бесплатной версии нет возможности оценить адекватность 
кеша. 

### Вариант второй

Использовать существующие веб-акселераторы, 

Разработчики **Varnish** утверждают 

> Varnish Cache is a web application accelerator also known as a caching HTTP reverse proxy. 
> You install it in front of any server that speaks HTTP and configure it to cache the contents. 
> Varnish Cache is really, really fast. 
> It typically speeds up delivery with a factor of 300 - 1000x, depending on your architecture.

  

